{"version":3,"file":"Tooltip-d5c775d4.js","sources":["../../src/hooks/useEventListener/index.ts","../../src/utils/debounce.ts","../../src/Tooltip/Tooltip.tsx"],"sourcesContent":["import { RefObject, useEffect } from 'react'\nimport { GenericEventCallback } from '../../types'\n\nexport const useEventListener = ({\n  eventName,\n  callback,\n  ref,\n  capture = false,\n}: {\n  eventName: keyof HTMLElementEventMap | string\n  callback: GenericEventCallback\n  ref: RefObject<HTMLElement | Document>\n  capture?: boolean\n}): void => {\n  useEffect(() => {\n    const refElement = ref && ref.current\n    if (!refElement) return\n    const listenerOptions = { capture }\n\n    refElement.addEventListener(eventName, callback, listenerOptions)\n\n    return () => {\n      refElement.removeEventListener(eventName, callback, listenerOptions)\n    }\n  }, [eventName, ref, callback, capture])\n}\n","/**\n * Debounces a method.\n * @param fn - The function to be debounced.\n * @param delay - The debouncing delay.\n * @returns A debounced version of the function.\n */\nexport const debounce = <Args extends unknown[], R>(\n  fn: (...args: Args) => R,\n  delay: number,\n): ((...args: Args) => void) => {\n  let timeout: NodeJS.Timeout | undefined\n\n  return (...args: Args): void => {\n    if (timeout) {\n      clearTimeout(timeout)\n    }\n\n    timeout = setTimeout(() => {\n      fn(...args)\n      timeout = undefined\n    }, delay)\n  }\n}\n","import React, {\n  FC,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react'\nimport { createPortal } from 'react-dom'\nimport styled, { css } from 'styled-components'\nimport { v4 as uuidv4 } from 'uuid'\nimport { Text } from '../Text'\nimport { useEventListener } from '../hooks'\nimport { theme } from '../theme'\nimport { debounce } from '../utils/debounce'\n\ntype Position = 'top' | 'bottom' | 'left' | 'right'\ntype ArrowPosition = Position | 'center'\n\nexport interface TooltipProps {\n  children: ReactNode\n  content: string | ReactNode\n  defaultArrowPosition: Position\n  maxWidth?: number\n  title?: string\n  underline?: boolean\n  fallbackStyle?: boolean\n}\n\nexport const Tooltip: FC<TooltipProps> = ({\n  children,\n  title,\n  content,\n  defaultArrowPosition = 'top',\n  maxWidth = 500,\n  underline = false,\n  fallbackStyle = false,\n}) => {\n  const documentRef = useRef<Document>(document)\n  const tipContainer = useRef<HTMLDivElement>(null)\n  const [showTip, setShowTip] = useState<boolean>(false)\n  const [tooltipPosition, setTooltipPosition] =\n    useState<Position>(defaultArrowPosition)\n  const [childEl, setChildEl] = useState<HTMLElement | null>(null)\n  const [tooltipCoords, setTooltipCoords] = useState({ top: 0, left: 0 })\n\n  const randomId = uuidv4()\n\n  const checkInbounds = (element: DOMRect): boolean =>\n    element.top >= 0 &&\n    element.left >= 0 &&\n    element.bottom <= window.innerHeight &&\n    element.right <= window.innerWidth\n\n  const handleTipViewport = useCallback(() => {\n    const dimensions = tipContainer.current?.getBoundingClientRect()\n\n    if (!dimensions) return\n    if (checkInbounds(dimensions)) return\n\n    // If in bounds but not defaulted to top; default\n    if (dimensions.top >= 0 && tooltipPosition !== 'top') {\n      setTooltipPosition('top')\n      return\n    }\n    // if top out of bounds\n    if (dimensions.top < 0) {\n      setTooltipPosition('bottom')\n      return\n    }\n    // if right out of bounds\n    if (dimensions.right > window.innerWidth) {\n      setTooltipPosition('left')\n      return\n    }\n    // if left out of bounds\n    if (dimensions.left < 0) {\n      setTooltipPosition('right')\n      return\n    }\n    // If bottom out of bounds\n    if (dimensions.bottom > window.innerHeight) {\n      setTooltipPosition('top')\n      return\n    }\n  }, [tipContainer, tooltipPosition])\n\n  useEffect(() => {\n    handleTipViewport()\n    setChildEl(document.getElementById(randomId))\n  }, [])\n\n  useEffect(() => {\n    setTooltipPosition(defaultArrowPosition)\n  }, [defaultArrowPosition])\n\n  const arrowSize = 18\n\n  const calculateTooltipPosition = (): { top: number; left: number } => {\n    if (!childEl) return { top: 0, left: 0 }\n    if (!tipContainer.current) return { top: 0, left: 0 }\n\n    const childPosition = childEl.getBoundingClientRect()\n    const tipDimensions = tipContainer.current.getBoundingClientRect()\n\n    let top = 0\n    let left = 0\n\n    switch (tooltipPosition) {\n      case 'top':\n        top =\n          childPosition.top + window.scrollY - tipDimensions.height - arrowSize\n        left =\n          childPosition.left +\n          window.scrollX +\n          childPosition.width / 2 -\n          tipDimensions.width / 2\n        break\n      case 'bottom':\n        top = childPosition.bottom + window.scrollY + arrowSize\n        left =\n          childPosition.left +\n          window.scrollX +\n          childPosition.width / 2 -\n          tipDimensions.width / 2\n        break\n      case 'left':\n        left =\n          childPosition.left + window.scrollX - tipDimensions.width - arrowSize\n        top =\n          childPosition.top +\n          window.scrollY +\n          childPosition.height / 2 -\n          tipDimensions.height / 2\n        break\n      case 'right':\n        left = childPosition.right + window.scrollX + arrowSize\n        top =\n          childPosition.top +\n          window.scrollY +\n          childPosition.height / 2 -\n          tipDimensions.height / 2\n        break\n      default:\n        break\n    }\n    return { top, left }\n  }\n\n  useEffect(() => {\n    if (childEl) {\n      setTooltipCoords(calculateTooltipPosition())\n    }\n  }, [\n    defaultArrowPosition,\n    window.scrollY,\n    tipContainer.current,\n    childEl,\n    childEl?.getBoundingClientRect().top,\n    childEl?.getBoundingClientRect().left,\n  ])\n\n  useEventListener({\n    eventName: 'resize',\n    callback: debounce(handleTipViewport, 100),\n    ref: documentRef,\n  })\n\n  useEventListener({\n    eventName: 'scroll',\n    callback: debounce(handleTipViewport, 100),\n    ref: documentRef,\n  })\n\n  return (\n    <Container>\n      <UnderlinedText\n        id={randomId}\n        underline={underline}\n        cursor=\"pointer\"\n        onMouseEnter={() => setShowTip(true)}\n        onMouseLeave={() => setShowTip(false)}\n      >\n        {children}\n      </UnderlinedText>\n      {childEl &&\n        createPortal(\n          <Tip\n            className=\"tooltip\"\n            showTip={showTip}\n            position={defaultArrowPosition}\n            arrowPosition={tooltipPosition}\n            ref={tipContainer}\n            maxWidth={maxWidth}\n            fallbackStyle={fallbackStyle}\n            style={{\n              position: 'absolute',\n              top: `${tooltipCoords.top}px`,\n              left: `${tooltipCoords.left}px`,\n            }}\n          >\n            {title && (\n              <Text\n                tag=\"h5\"\n                typo=\"desc-medium\"\n                color={fallbackStyle ? 'cream' : 'liquorice'}\n              >\n                {title}\n              </Text>\n            )}\n            {(typeof content === 'string' && (\n              <Text\n                typo=\"desc-light\"\n                color={fallbackStyle ? 'cream' : 'liquorice'}\n              >\n                {content}\n              </Text>\n            )) ||\n              content}\n          </Tip>,\n          document.body,\n        )}\n    </Container>\n  )\n}\n\nexport const Container = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  > span:hover + .tooltip {\n    opacity: 1;\n  }\n`\n\nconst UnderlinedText = styled(Text)<{ underline: boolean }>`\n  ${({ underline }) =>\n    underline &&\n    css`\n      border-bottom: 1px dashed ${theme.colors.marshmallowPink};\n    `}\n`\n\nconst arrowInset = 26\nconst arrowCenterPosition = 'calc(50% - 6px)'\nconst arrowVerticalCenter = 'calc(50% - 12px)'\n\nconst handleHorizontalArrowPosition = (arrowPosition: ArrowPosition) => {\n  switch (arrowPosition) {\n    case 'left':\n      return css`\n        left: ${arrowInset}px;\n      `\n    case 'right':\n      return css`\n        right: ${arrowInset}px;\n      `\n    default:\n      return css`\n        left: ${arrowCenterPosition};\n      `\n  }\n}\n\nconst handleVerticalArrowPosition = (arrowPosition: ArrowPosition) => {\n  switch (arrowPosition) {\n    case 'top':\n      return css`\n        top: ${arrowInset}px;\n      `\n    case 'bottom':\n      return css`\n        bottom: ${arrowInset}px;\n      `\n    default:\n      return css`\n        top: ${arrowVerticalCenter};\n      `\n  }\n}\n\nconst top = css<{ arrowPosition: ArrowPosition }>`\n  &:before {\n    bottom: -15px;\n    transform: rotate(-90deg);\n    ${({ arrowPosition }) => handleHorizontalArrowPosition(arrowPosition)}\n  }\n`\n\nconst bottom = css<{ arrowPosition: ArrowPosition }>`\n  &:before {\n    top: -15px;\n    transform: rotate(90deg);\n    ${({ arrowPosition }) => handleHorizontalArrowPosition(arrowPosition)}\n  }\n`\n\nconst left = css<{ arrowPosition: ArrowPosition }>`\n  &:before {\n    right: -11px;\n    transform: rotate(180deg);\n    ${({ arrowPosition }) => handleVerticalArrowPosition(arrowPosition)}\n  }\n`\n\nconst right = css<{ arrowPosition: ArrowPosition }>`\n  &:before {\n    left: -11px;\n    ${({ arrowPosition }) => handleVerticalArrowPosition(arrowPosition)}\n  }\n`\n\nexport const Tip = styled.div<{\n  showTip: boolean\n  position: Position\n  arrowPosition: ArrowPosition\n  maxWidth?: number\n  fallbackStyle?: boolean\n}>`\n  position: absolute;\n  margin: auto;\n  background: ${theme.colors.custard};\n  padding: 16px 12px 20px;\n  border-radius: 16px;\n  max-width: 450px;\n  opacity: ${({ showTip }) => (showTip ? '1' : '0')};\n  transition: opacity 0.2s ease-in-out;\n  pointer-events: none;\n  cursor: default;\n  z-index: 10;\n\n  // this is the trick that will make sure the content can go up to maxWidth\n  margin-right: ${({ maxWidth }) => maxWidth && -maxWidth / 2 + 'px'};\n  max-width: ${({ maxWidth }) => maxWidth && maxWidth + 'px'};\n\n  ${({ arrowPosition }) => arrowPosition === 'top' && top}\n  ${({ arrowPosition }) => arrowPosition === 'bottom' && bottom}\n\t${({ arrowPosition }) => arrowPosition === 'left' && left}\n\t${({ arrowPosition }) => arrowPosition === 'right' && right}\n\n  &:before {\n    content: '';\n    border-style: solid;\n    border-width: 12px 12px 12px 0;\n    border-color: transparent ${theme.colors.custard} transparent transparent;\n    position: absolute;\n  }\n\n  ${({ fallbackStyle }) =>\n    fallbackStyle &&\n    css`\n      background: ${theme.colors.feijoa};\n      &:before {\n        border-color: transparent ${theme.colors.feijoa} transparent transparent;\n      }\n    `};\n`\n"],"names":["useEventListener","eventName","callback","ref","capture","useEffect","refElement","listenerOptions","debounce","fn","delay","timeout","args","Tooltip","children","title","content","defaultArrowPosition","maxWidth","underline","fallbackStyle","documentRef","useRef","tipContainer","showTip","setShowTip","useState","tooltipPosition","setTooltipPosition","childEl","setChildEl","tooltipCoords","setTooltipCoords","randomId","uuidv4","checkInbounds","element","handleTipViewport","useCallback","dimensions","_a","arrowSize","calculateTooltipPosition","childPosition","tipDimensions","top2","left2","jsxs","Container","jsx","UnderlinedText","createPortal","Tip","Text","styled","css","theme","arrowInset","arrowCenterPosition","arrowVerticalCenter","handleHorizontalArrowPosition","arrowPosition","handleVerticalArrowPosition","top","bottom","left","right"],"mappings":"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"}